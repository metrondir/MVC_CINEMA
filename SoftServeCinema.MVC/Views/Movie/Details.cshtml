@model SoftServeCinema.Core.DTOs.Movies.MovieFullDTO

@{
    ViewData["Title"] = "Фільм: " + Model.Title;
}

<div>
    <h3 class="text-center my-4">Фільм</h3>

    <div class="list-group my-4">
        <div class="row justify-content-between">
            <h2>@Model.Title</h2>
            <img class="w-25 m-auto" src="@Url.Content("~/images/" + Model.ImagePath)" alt="@Model.Title">
            <p>Жанр: @(string.Join(", ", Model.Genres.Select(g => g.Name)))</p>
            <p>Тег: @(string.Join(", ", Model.Tags.Select(t => t.Name)))</p>
            <p>Режисер: @(string.Join(", ", Model.Directors.Select(d => d.Name)))</p>
            <p>Актори: @(string.Join(", ", Model.Actors.Select(a => a.Name)))</p>
            <p>Прокат: З @Model.StartRentalDate.ToShortDateString() до @Model.EndRentalDate.ToShortDateString()</p>
            <p>Тривалість: @Model.Duration хв.</p>
            <p>Рік: @Model.GraduationYear</p>


            <div class="accordion" id="accordionExample">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                           Сьогодні
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <div id="todaySession">
                                @foreach (var session in Model.Sessions.Where(s => s.StartDate.Day == DateTime.UtcNow.Day))
                                {
                                    
                                    <p>
                                        <a class="nav-link text-dark @(session.Tickets.Count() == 0 ? "disabled" : "")" asp-area="" asp-controller="Session" asp-action="Details" asp-route-id="@session.Id">@session.StartDate.ToShortTimeString() </a>
                                    </p>

                                }
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            Завтра 
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <div id="tomorrowSession">

                                @foreach (var session in Model.Sessions.Where(s => s.StartDate.Day == DateTime.UtcNow.AddDays(1).Day))
                                {

                                    <p>
                                        <a class="nav-link text-dark @(session.Tickets.Count() == 0 ? "disabled" : "")" asp-area="" asp-controller="Session" asp-action="Details" asp-route-id="@session.Id">@session.StartDate.ToShortTimeString() </a>
                                    </p>

                                }
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            Протягом тижня
                        </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <div id="weekSessions">
                                @for (int i = 3; i <= 7; i++)
                                {
                                    if (Model.Sessions.Where(s => s.StartDate.Day <= DateTime.UtcNow.AddDays(i).Day && s.StartDate.Day > DateTime.UtcNow.AddDays(i - 1).Day).Count() != 0)
                                    {

                                        <div>
                                            <p>@DateTime.UtcNow.AddDays(i).ToShortDateString()</p>
                                            @foreach (var session in Model.Sessions.Where(s => s.StartDate.Day <= DateTime.UtcNow.AddDays(i).Day && s.StartDate.Day > DateTime.UtcNow.AddDays(i - 1).Day))
                                            {
                                                <p>
                                                    <a class="nav-link text-dark @(session.Tickets.Count() == 0 ? "disabled" : "")" asp-area="" asp-controller="Session" asp-action="Details" asp-route-id="@session.Id">@session.StartDate.ToShortTimeString() </a>
                                                </p>

                                            }
                                        </div>
                                    }
                                }

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            
          
            <iframe width="560" height="315" src="@Model.TrailerUrl" frameborder="0" allowfullscreen></iframe>
            <h3>Опис</h3>
            <p>@Model.Desc</p>
        </div>
    </div>
</div>